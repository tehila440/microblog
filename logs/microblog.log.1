2023-08-03 19:16:14,826 ERROR: Exception on /index [POST] [in /Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py:1414]
Traceback (most recent call last):
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "/Users/tehila/TR_microblog/microblog/app/main/routes.py", line 35, in index
    db.session.commit()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/sqlalchemy/orm/scoping.py", line 552, in commit
    return self._proxied.commit()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1920, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1246, in commit
    self.session.dispatch.after_commit(self.session)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/sqlalchemy/event/attr.py", line 378, in __call__
    fn(*args, **kw)
  File "/Users/tehila/TR_microblog/microblog/app/models.py", line 40, in after_commit
    add_to_index(obj.__tablename__, obj)
  File "/Users/tehila/TR_microblog/microblog/app/search.py", line 10, in add_to_index
    current_app.elasticsearch.index(index=index, id=model.id, body=payload)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/elasticsearch/_sync/client/utils.py", line 414, in wrapped
    return api(*args, **kwargs)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/elasticsearch/_sync/client/__init__.py", line 2318, in index
    return self.perform_request(  # type: ignore[return-value]
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/elasticsearch/_sync/client/_base.py", line 285, in perform_request
    meta, resp_body = self.transport.perform_request(
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/elastic_transport/_transport.py", line 329, in perform_request
    meta, raw_data = node.perform_request(
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/elastic_transport/_node/_http_urllib3.py", line 199, in perform_request
    raise err from None
elastic_transport.ConnectionError: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fb6c601adf0>: Failed to establish a new connection: [Errno 61] Connection refused))
2023-08-03 19:16:32,243 INFO: Microblog startup [in ./app/__init__.py:79]
2023-08-03 19:18:02,817 ERROR: Unhandled exception [in ./app/tasks.py:61]
Traceback (most recent call last):
  File "./app/tasks.py", line 53, in export_posts
    send_email('[Microblog] Your blog posts',
  File "./app/email.py", line 20, in send_email
    mail.send(msg)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask_mail.py", line 491, in send
    with self.connect() as connection:
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask_mail.py", line 144, in __enter__
    self.host = self.configure_host()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask_mail.py", line 158, in configure_host
    host = smtplib.SMTP(self.mail.server, self.mail.port)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/smtplib.py", line 253, in __init__
    (code, msg) = self.connect(host, port)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/smtplib.py", line 339, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/smtplib.py", line 308, in _get_socket
    return socket.create_connection((host, port), timeout,
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/socket.py", line 808, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/socket.py", line 796, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused
2023-08-03 19:22:40,181 INFO: Microblog startup [in /Users/tehila/TR_microblog/microblog/app/__init__.py:79]
2023-08-03 19:22:52,679 INFO: Microblog startup [in /Users/tehila/TR_microblog/microblog/app/__init__.py:79]
2023-08-03 20:48:13,886 INFO: Microblog startup [in /Users/tehila/TR_microblog/microblog/app/__init__.py:79]
2023-08-03 21:06:57,516 INFO: Microblog startup [in /Users/tehila/TR_microblog/microblog/app/__init__.py:79]
2023-08-03 21:07:16,247 ERROR: Exception on /export_posts [GET] [in /Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py:1414]
Traceback (most recent call last):
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/connection.py", line 707, in connect
    sock = self.retry.call_with_retry(
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/connection.py", line 708, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/connection.py", line 1006, in _connect
    raise err
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/connection.py", line 994, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "/Users/tehila/TR_microblog/microblog/app/main/routes.py", line 225, in export_posts
    current_user.launch_task('export_posts', _('Exporting posts...'))
  File "/Users/tehila/TR_microblog/microblog/app/models.py", line 138, in launch_task
    rq_job = current_app.task_queue.enqueue('app.tasks.' + name, self.id,
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/rq/queue.py", line 972, in enqueue
    return self.enqueue_call(
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/rq/queue.py", line 721, in enqueue_call
    return self.enqueue_job(job, pipeline=pipeline, at_front=at_front)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/rq/queue.py", line 1095, in enqueue_job
    return self._enqueue_job(job, pipeline=pipeline, at_front=at_front)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/rq/queue.py", line 1115, in _enqueue_job
    job.redis_server_version = self.get_redis_server_version()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/rq/queue.py", line 219, in get_redis_server_version
    self.redis_server_version = get_version(self.connection)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/rq/utils.py", line 293, in get_version
    tuple(int(i) for i in connection.info("server")["redis_version"].split('.')[:3]),
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/commands/core.py", line 993, in info
    return self.execute_command("INFO", section, *args, **kwargs)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/client.py", line 1266, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/connection.py", line 1461, in get_connection
    connection.connect()
  File "/Users/tehila/TR_microblog/microblog/venv/lib/python3.8/site-packages/redis/connection.py", line 713, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:6379. Connection refused.
